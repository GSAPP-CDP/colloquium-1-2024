<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Add custom icons with Markers</title>
<meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
<link href="https://api.mapbox.com/mapbox-gl-js/v3.5.1/mapbox-gl.css" rel="stylesheet">
<script src="https://api.mapbox.com/mapbox-gl-js/v3.5.1/mapbox-gl.js"></script>
<style>
body { margin: 0; padding: 0; }
#map { position: absolute; top: 0; bottom: 0; width: 100%; }
</style>
</head>
<body>
<style>
    .marker {
        display: block;
        border: none;
        cursor: pointer;
        padding: 0;
        background-size: cover;
    }
</style>

<div id="map"></div>

<script>
	mapboxgl.accessToken = 'pk.eyJ1IjoicGFueWFudXMiLCJhIjoiY2x6MXo0Ym9jMWZ6cjJrb2l6YXk2NnAzaSJ9._smojqWBDds304Vg0Ubtmw';

    const map = new mapboxgl.Map({
        container: 'map',
        // Choose from Mapbox's core styles, or make your own style with Mapbox Studio
        style: 'mapbox://styles/mapbox/light-v11',
        center: [100.5018, 13.7563],
        zoom: 12
    });

    // Variable to keep track of the currently playing audio
    let currentAudio = null;

    // Load the GeoJSON file
    fetch('20nearestcommu.geojson')
        .then(response => response.json())
        .then(data => {
            data.features.forEach((feature, index) => {
                const coordinates = feature.geometry.coordinates;
                const name = feature.properties.Name;
                const imageId = index + 1; // Assuming image names are sequential like image1.jpg, image2.jpg, etc.
                const imageUrl = `images/image${imageId}.jpg`;
                const soundUrl = `sounds/sound${imageId}.mp3`; // Assuming sound names are sequential like sound1.mp3, sound2.mp3, etc.

                const el = document.createElement('div');
                el.className = 'marker';
                el.style.backgroundImage = `url(${imageUrl})`;
                el.style.width = '60px'; // Adjust the width as needed
                el.style.height = '40px'; // Adjust the height as needed
                el.style.backgroundSize = 'cover';

                // Create an audio element for the sound
                const audio = new Audio(soundUrl);

                el.addEventListener('click', () => {
                    // Stop the current audio if it is playing
                    if (currentAudio && !currentAudio.paused) {
                        currentAudio.pause();
                        currentAudio.currentTime = 0;
                    }

                    // Play the new audio and set it as the current audio
                    audio.play();
                    currentAudio = audio;
                });

                new mapboxgl.Marker(el)
                    .setLngLat(coordinates)
                    .setPopup(new mapboxgl.Popup({ offset: 25 }).setText(name)) // sets a popup on this marker
                    .addTo(map);
            });
        })
        .catch(err => console.error('Error loading GeoJSON file:', err));
</script>

</body>
</html>
//Explore the hidden alleys of Bangkok through this interactive map, where ancient crafts quietly thrive amidst urban sprawl. Each marker reveals an image and sound, bringing to life the vibrant traditions and stories of these resilient communities. Journey through the heart of the city, discovering the harmonious blend of past and present as you listen to the unique sounds of each craft. Celebrate the enduring spirit and skill of Bangkok's artisans, preserving their heritage one click at a time.